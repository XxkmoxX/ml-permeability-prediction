## Predicting equivalent hydraulic conductivity (_K<sub>eq</sub>_) of synthetic reservoirs using machine learning techniques

This project aims to develop machine learning models for predicting _K<sub>eq</sub>_ based on 2D geometric connectivity indicators. The project includes various models, data preprocessing steps, and evaluation metrics to ensure robust predictions.

### **1 - Introduction**
Reservoir engineering uses numerical simulation to model and predict the behavior of fluids in a reservoir over time. It involves the creation of mathematical and computational models that represent the geological and fluid dynamic properties of the reservoir rock. These models are based on geological data, geophysical surveys, laboratory tests, well tests, production histories, among other sources of information, and allow for the simulation of how fluids move in the Earth's subsurface, as well as how they can be extracted or injected to or from the surface (Steve 2018). This discipline has applications in the energy sector, such as oil and gas extraction, geothermal energy production, groundwater production, underground contaminant transport, and carbon dioxide capture and storage (CCUS).

These models are used to construct maps composed of cells that characterize the reservoir at high-resolution scales. Because simulations at these scales require extensive computational resources, an upscaling procedure is necessary to transfer the petrophysical properties and characteristics of the high-resolution fine grid to a low-resolution simulation grid.

**Fig. 1** shows maps of the logarithm of point hydraulic conductivity, log(*k(**r**)*), as a function of coordinates in two-dimensional space. The map on the left is represented on a fine-grid scale whose petrophysical properties, such as point hydraulic conductivity *k(**r**)*, are sampled with high spatial resolution. The upscaling procedure allows the petrophysical properties to be transferred to a simulation map or coarse grid (map on the right) where the characteristic values ​​of the equivalent hydraulic conductivity *K<sub>eq<sub/>* are distributed with a reduction in spatial resolution. This allows simulations and calculations to be carried out with acceptable computational requirements. The homogenization procedure that allows a representative *K<sub>eq<sub/>* value to be determined for a given block, based on the *k(**r**)* values, is called 'upscaling'.

![upscaling](plots/01_upscaling_seismic.png)<sub>**Fig. 1:** Spatial scales used in upscaling procedures. The map on the left, with linear size *L*=256*Δ*, defines the point values ​​of hydraulic conductivity *k(**r**)* on the fine grid with linear cell size *Δ* (this length is given by the image pixel size). The integral scale or correlation length *l<sub>c<sub/>*=16*Δ* provides the characteristic length scale of the heterogeneity. After upscaling, the equivalent hydraulic conductivity Keq is defined on each block of the coarse grid with linear cell size *λ*=32*Δ*.

In each reservoir realization or sample, *k(**r**)* is considered a random process characterized by a probability density function P[*log*(*k(**r**)*)], and the spatial variation of *k(**r**)* is defined by a covariance function with a certain integral length scale lc. The realizations can then be conditioned on the available field data. In lognormal or multi-Gaussian media, the mean and variance of P[*log*(*k(**r**)*)] may be sufficient to determine Keq (De Wit, 1995; Colecchio et al., 2020). However, in certain scenarios, for example if there are tortuous channels where preferential flows are manifested, it has been shown (Western et al., 2001) that additional information on the spatial organization of *k(**r**)* is required. Zinn and Harvey (2003) and Jankovic et al. (2016) modified continuous multi-Gaussian fields in which *k(**r**)* classes or facies with intermediate values ​​are connected, while *k(**r**)* classes with extreme values ​​are disconnected, by applying a Normal Score Transform (NST) to exchange the intermediate *k(**r**)* classes with the high (low) *k(**r**)* classes. This allows increasing (decreasing) the connectivity of the high (low) *k(**r**)* classes without modifying P[*log*(*k(**r**)*)] or the spatial covariance function. The different connectivity structures can be observed in **Fig. 2**: high, intermediate and low.

